
vertical_table_parser: &VERTICAL_TABLE_PARSER network_insight_sdk_generic_datasources.parsers.common.vertical_table_parser.VerticalTableParser
horizontal_table_parser: &HORIZONTAL_TABLE_PARSER network_insight_sdk_generic_datasources.parsers.common.horizontal_table_parser.HorizontalTableParser
generic_text_parser: &GENERIC_TEXT_PARSER network_insight_sdk_generic_datasources.parsers.common.text_parser.GenericTextParser

package_handler: &PACKAGE_HANDLER
  name: ZipPackageHandler
  arguments:
    path: /tmp/uani
    filename: juniper-srx

# Commands added will be executed in sequence
command_list: &COMMAND_LIST
  - &SHOW_VERSION
    table_id: switch
    command: show version
    parser:
      pre_post_processor: JuniperSRXDevicePrePostProcessor
      name: *VERTICAL_TABLE_PARSER

  - &SHOW_ROUTE_DETAIL
    table_id: routes
    command: show route detail | no-more
    parser:
      pre_post_processor: JuniperSRXRoutePrePostProcessor
      name: parsers.common.block_parser.SimpleBlockParser

  - &SHOW_INTERFACE
    table_id: switch-ports
    command: show interfaces detail | no-more
    parser:
      pre_post_processor: JuniperSwitchPortPrePostProcessor
      name: parsers.common.block_parser.SimpleBlockParser

  - &SHOW_ROUTER_INTERFACES
    table_id: router-interfaces
    reuse_command: show interfaces detail | no-more
    parser:
      pre_post_processor: JuniperRouterInterfacePrePostProcessor
      name: parsers.common.block_parser.SimpleBlockParser

  - &SHOW_PORT_CHANNELS
    table_id: port-channels
    reuse_command: show interfaces detail | no-more
    parser:
      pre_post_processor: JuniperPortChannelPrePostProcessor
      name: parsers.common.block_parser.SimpleBlockParser

  - &SHOW_LLDP_NEIGHBORS
    table_id: neighbors
    command: show lldp neighbors | no-more
    parser:
      pre_post_processor: JuniperNeighborsTablePrePostProcessor
      name: parsers.common.block_parser.SimpleBlockParser

  - &SHOW_ARP_NO_RESOLVE
    table_id: mac-address-table
    command: show arp no-resolve | no-more
    parser:
      pre_post_processor: JuniperMACTablePrePostProcessor
      name: *HORIZONTAL_TABLE_PARSER
      arguments:
        skip_head: 1
        skip_tail: 1
        header_keys:
          - macAddress
          - address
          - switchPort
          - Flags
    select_columns:
      macAddress: macAddress
      switchPort: switchPort
      vlan: vlan

  - &SHOW_VRF
    table_id: vrfs
    command: show route instance detail | no-more
    parser:
      pre_post_processor: JuniperSRXVRFPrePostProcessor
      name: *VERTICAL_TABLE_PARSER

result_writer: &RESULT_WRITER
  name: CsvWriter
  path: /tmp/uani
  table_id:
    - switch
    - routes
    - neighbors
    - mac-address-table
    - switch-ports
    - router-interfaces
    - vrfs


srx: !include srx.yml

