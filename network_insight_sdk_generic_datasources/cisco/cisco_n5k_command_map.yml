credentials:
  device_type: CISCO_IOS
  ip_or_fqdn: 10.40.13.36
  username: admin
  password: Vnera655

package_handler:
  name: ZipPackageHandler
  arguments:
    path: /tmp/uani
    filename: cisco-device
# Commands added will be executed in sequence
command_list:
  -
    table_id: switch
    command: show version
    parser:
      pre_post_processor: cisco.cisco_pre_post_processor.CiscoDevicePrePostProcessor
      name: parsers.common.vertical_table_parser.VerticalTableParser
  -
    table_id: mac-address-table
    command: show mac address-table | xml | exclude disp_vdc | exclude disp_is_static | exclude disp_is_secure | exclude disp_is_ntfy | exclude disp_type | exclude disp_swid | exclude disp_age | exclude disp_sswid | exclude disp_lid
    block_parser:
      name: parsers.common.block_parser.PatternBasedBlockParser
      arguments:
        start_pattern: "<ROW_mac_address>"
        end_pattern: "</ROW_mac_address>"
    parser:
      name: parsers.common.text_parser.GenericTextParser
      arguments:
        rules:
          macAddress: "<disp_mac_addr>(.*)</disp_mac_addr>"
          vlan: "<disp_vlan>(.*)</disp_vlan>"
          switchPort: "<disp_port>(.*)</disp_port>"
  -
    table_id: neighbors
    command: show cdp neighbors | xml
    block_parser:
      name: parsers.common.block_parser.PatternBasedBlockParser
      arguments:
        start_pattern: '<ROW_cdp_neighbor_brief_info>'
        end_pattern: '</ROW_cdp_neighbor_brief_info>'
    parser:
      name: parsers.common.text_parser.GenericTextParser
      arguments:
        rules:
          remoteDevice: "<device_id>(.*)</device_id>"
          localInterface: "<intf_id>(.*)</intf_id>"
          remoteInterface: "<port_id>(.*)</port_id>"
  -
    table_id: routes
    command: show ip route vrf all
    block_parser:
      name: parsers.common.block_parser.LineBasedBlockParser
      arguments:
        line_pattern: 'IP Route Table for VRF'
    parser:
      pre_post_processor: cisco.cisco_pre_post_processor.CiscoRoutePrePostProcessor
      name: parsers.common.horizontal_table_parser.HorizontalTableParser
      arguments:
        header_keys:
          - name
          - network
          - nextHop
          - interfaceName
          - routeType
          - vrf
  -
    table_id: showSwitchPorts
    command: show interface
    block_parser:
      name: parsers.common.block_parser.LineBasedBlockParser
      arguments:
        line_pattern: '(\w+) is (up|down)'
    parser:
      pre_post_processor: cisco.cisco_pre_post_processor.CiscoSwitchPortPrePostProcessor
      name: parsers.common.text_parser.GenericTextParser
      arguments:
        rules:
          name: "(.*) is (?:up|down).*"
          connected: ".* is.*(up|down).*"
          accessVlan: "Vlan(\\d+) is up|down"
          administrativeStatus: ".* is.*(up|down).*"
          operationalStatus: ".* is.*(up|down).*"
          hardwareAddress: ".* address.* (\\w+\\.\\w+\\.\\w+)"
          interfaceSpeed: ".* BW (\\w+) Kbit.*"
          operationalSpeed: ".* BW (\\w+) Kbit.*"
          mtu: "^MTU (\\w+) bytes.*"
          duplex: "(\\w+)\\-duplex.*"
          switchPortMode: "Port mode is (\\w+)"
  -
    table_id: showRouterInterfaces
    reuse_command: show interface
    block_parser:
      name: parsers.common.block_parser.LineBasedBlockParser
      arguments:
        line_pattern: '(\w+) is (up|down)'
    parser:
      pre_post_processor: cisco.cisco_pre_post_processor.CiscoRouterInterfacePrePostProcessor
      name: parsers.common.text_parser.GenericTextParser
      arguments:
        rules:
          name: "(.*) is (?:up|down).*"
          connected: ".* is.*(up|down).*"
          accessVlan: "Vlan(\\d+) is up|down"
          administrativeStatus: ".* is.*(up|down).*"
          operationalStatus: ".* is.*(up|down).*"
          hardwareAddress: ".* address.* (\\w+\\.\\w+\\.\\w+)"
          interfaceSpeed: ".* BW (\\w+) Kbit.*"
          operationalSpeed: ".* BW (\\w+) Kbit.*"
          mtu: "^MTU (\\w+) bytes.*"
          ipAddress: "^Internet Address is (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/\\d{1,3})"
          duplex: "(\\w+)\\-duplex.*"
          switchPortMode: "Port mode is (\\w+)"
  -
    table_id: showPortChannels
    command: show interface | section port-channel
    parser:
      name: parsers.common.text_parser.GenericTextParser
      arguments:
        rules:
          name: "(.*) is (?:up|down).*"
          connected: ".* is.*(up|down).*"
          accessVlan: "Vlan(\\d+) is up|down"
          administrativeStatus: ".* is.*(up|down).*"
          operationalStatus: ".* is.*(up|down).*"
          hardwareAddress: ".* address.* (\\w+\\.\\w+\\.\\w+)"
          interfaceSpeed: ".* BW (\\w+) Kbit.*"
          operationalSpeed: ".* BW (\\w+) Kbit.*"
          mtu: "^MTU (\\w+) bytes.*"
          ipAddress: "^Internet Address is (\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}/\\d{1,3})"
          duplex: "(\\w+)\\-duplex.*"
          switchPortMode: "Port mode is (\\w+)"
          activePorts: "Members in this channel: (.*)"
          passivePorts: "passive"
  -
    table_id: vrfs
    command: show vrf all
    parser:
      name: parsers.common.horizontal_table_parser.HorizontalTableParser
      arguments:
        skip_head: 1
        header_keys:
          - name
          - id
          - state
          - reason
    select_columns:
      name: name
  -
    table_id: showRIVrf
    command: show ip interface vrf all | include 'Interface (S|s)tatus'
    block_parser:
      name: parsers.common.block_parser.LineBasedBlockParser
      arguments:
        line_pattern: 'IP Interface Status for VRF'
    parser:
      pre_post_processor: cisco.cisco_pre_post_processor.CiscoRouterInterfaceVrfPrePostProcessor
      name: parsers.common.horizontal_table_parser.HorizontalTableParser
      arguments:
        header_keys:
          - interfaceName
          - vrf
  -
    table_id: showVlan
    command: show vlan brief
    parser:
      pre_post_processor: cisco.cisco_pre_post_processor.CiscoInterfaceVlanPrePostProcessor
      name: parsers.common.horizontal_table_parser.HorizontalTableParser
      arguments:
        skip_head: 1
        header_keys:
          - vlan
          - name
          - status
          - ports
table_joiners:
  -
    name: joiner.table_joiner.SimpleTableJoiner
    source_table: showRIVrf
    destination_table: showRouterInterfaces
    source_column: interfaceName
    destination_column: name
    joined_table_id: router-interfaces
  -
    name: joiner.table_joiner.SimpleTableJoiner
    source_table: showVlan
    destination_table: showSwitchPorts
    source_column: port
    destination_column: name
    joined_table_id: switch-ports
  -
    name: joiner.table_joiner.SimpleTableJoiner
    source_table: showVlan
    destination_table: showPortChannels
    source_column: port
    destination_column: name
    joined_table_id: port-channels
result_writer:
  name: CsvWriter
  path: /tmp/uani
  table_id:
    - switch
    - mac-address-table
    - neighbors
    - routes
    - vrfs
    - router-interfaces
    - switch-ports
    - port-channels
